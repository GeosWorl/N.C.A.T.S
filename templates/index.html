<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N.C.A.T.S - Nell's Carpool and Transportation Services</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    {% if recaptcha_site_key %}
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    {% endif %}
</head>
<body>
    <div class="container">
        <header>
            <h1>N.C.A.T.S - Nell's Carpool and Transportation Services</h1>
            <p class="subtitle">Transportation Services with Blockchain Integration</p>
        </header>

        <nav>
            {% if is_logged_in %}
                <p>Welcome, {{ username }}! | <a href="{{ url_for('profile') }}">My Profile</a> | <a href="{{ url_for('logout') }}">Logout</a></p>
            {% else %}
                <p><a href="#login">Login</a> | <a href="#register">Register</a></p>
            {% endif %}
        </nav>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="messages">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        <main>
            <section class="info">
                <h2>About Our Service</h2>
                <p>N.C.A.T.S (Nell's Carpool and Transportation Services) is a modern transportation company leveraging blockchain technology for secure and transparent business operations.</p>
                <p>Our smart contract is deployed at: <code>0x721ED067e04dC811c94c9A0C45b6160De799E2C0</code></p>
            </section>

            {% if not is_logged_in %}
            <section id="login" class="form-section">
                <h2>Login</h2>
                <form method="POST" action="{{ url_for('login') }}">
                    {{ login_form.hidden_tag() }}
                    <div class="form-group">
                        {{ login_form.username.label }}
                        {{ login_form.username(class="form-control") }}
                    </div>
                    <div class="form-group">
                        {{ login_form.password.label }}
                        {{ login_form.password(class="form-control") }}
                    </div>
                    {% if recaptcha_site_key %}
                    <div class="g-recaptcha" data-sitekey="{{ recaptcha_site_key }}"></div>
                    {% endif %}
                    <div class="form-group">
                        {{ login_form.submit(class="btn btn-primary") }}
                    </div>
                    <p><a href="{{ url_for('reset_request') }}">Forgot Password?</a></p>
                </form>
            </section>

            <section id="register" class="form-section">
                <h2>Register</h2>
                <form method="POST" action="{{ url_for('register') }}">
                    {{ register_form.hidden_tag() }}
                    <div class="form-group">
                        {{ register_form.username.label }}
                        {{ register_form.username(class="form-control") }}
                    </div>
                    <div class="form-group">
                        {{ register_form.email.label }}
                        {{ register_form.email(class="form-control") }}
                    </div>
                    <div class="form-group">
                        {{ register_form.password.label }}
                        {{ register_form.password(class="form-control") }}
                    </div>
                    {% if recaptcha_site_key %}
                    <div class="g-recaptcha" data-sitekey="{{ recaptcha_site_key }}"></div>
                    {% endif %}
                    <div class="form-group">
                        {{ register_form.submit(class="btn btn-primary") }}
                    </div>
                </form>
            </section>
            {% endif %}

            {% if is_logged_in %}
            <section id="apply" class="form-section">
                <h2>Submit Application</h2>
                <form method="POST" action="{{ url_for('apply') }}" enctype="multipart/form-data">
                    {{ apply_form.hidden_tag() }}
                    <div class="form-group">
                        {{ apply_form.name.label }}
                        {{ apply_form.name(class="form-control") }}
                    </div>
                    <div class="form-group">
                        {{ apply_form.email.label }}
                        {{ apply_form.email(class="form-control") }}
                    </div>
                    <div class="form-group">
                        {{ apply_form.resume.label }}
                        {{ apply_form.resume(class="form-control") }}
                        <small>Accepted formats: PDF, DOC, DOCX</small>
                    </div>
                    <div class="form-group">
                        {{ apply_form.submit(class="btn btn-primary") }}
                    </div>
                </form>
            </section>
            {% endif %}
        </main>

        <footer>
            <p>&copy; 2024 N.C.A.T.S - Nell's Carpool and Transportation Services</p>
            <p>Owned by Cory K Washington (Geo)</p>
        </footer>
    </div>
</body>
</html>
